function Set-DNSFix{
$servers = @()
while($DNSserver -ne "q"){
    $DNSserver = read-host -prompt "Enter Server Name for Registry Fix - Enter q to Finish"
    if($DNSserver -eq $null -OR $DNSserver -eq ""){
        write-output "No Servers Added - ending script"
        pause
        exit
        }
     elseif($DNSserver -ne "q")
        {
            $servers += $DNSserver
        }
    }

$credential = Get-Credential -Message "Enter Administrator Credentials to connect to servers"

foreach($server in $servers){
    write-output "Processing Server: $Server"
    $DNSFix = New-PSSession -ComputerName $server -Credential $credential
    Invoke-Command -Session $DNSFix -Scriptblock {
        $registryPath = "HKLM:\System\CurrentControlSet\Services\DNS\Parameters"
        $Name = "TcpReceivePacketSize"
        $value = "0x0000FF00"
        New-ItemProperty -Path $registryPath -Name $name -Value $value -PropertyType DWORD -Force | Out-Null
        Restart-Service -Name DNS
        Get-ItemProperty $registryPath -name $name
    }
    Remove-PSSession $DNSFix.ID
}
Get-Variable -Exclude PWD,*Preference | Remove-Variable -EA 0
}